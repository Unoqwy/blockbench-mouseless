{"version":3,"sources":["/home/runner/work/blockbench-mouseless/blockbench-mouseless/src/utils.ts","/home/runner/work/blockbench-mouseless/blockbench-mouseless/src/mouseless.ts","/home/runner/work/blockbench-mouseless/blockbench-mouseless/src/ui.ts","/home/runner/work/blockbench-mouseless/blockbench-mouseless/src/index.ts"],"sourcesContent":["export function removeFromArray<T>(array: T[], elt: T): boolean {\n    const eltIndex = array.indexOf(elt);\n    if (eltIndex != -1) {\n        array.splice(eltIndex, 1);\n        return true;\n    }\n    return false;\n}\n","import { removeFromArray } from \"./utils\";\n\nexport namespace Mouseless {\n    var styleElement: HTMLStyleElement;\n\n    // keep track of added actions to remove them on unload\n    const actions: Action[] = [];\n\n    export function createAction(id: string, opts: ActionOptions) {\n        actions.push(new Action(id, opts));\n    }\n\n    export function hook(cssSource?: string) {\n        if (cssSource !== undefined) {\n            styleElement = document.createElement(\"style\");\n            styleElement.id = \"mouseless-css\";\n            styleElement.innerHTML = cssSource;\n            document.getElementsByTagName(\"head\")[0].appendChild(styleElement);\n        }\n    }\n\n    export function postInit() {\n        Object.values(Toolbars).forEach(toolbar => {\n            if ((toolbar as any).postload) {\n                console.log(toolbar);\n                toolbar.update();\n            }\n        });\n    }\n\n    export function unhook() {\n        styleElement.remove();\n        actions.forEach(unloadAction);\n    }\n}\n\n/**\n * Unload an action but avoid calling save to keep it in storage.\n * This allows for plugin reloading and upadting by preventing leftovers from previous iter\n * yet keeping the user's toolbars as they are.\n */\nfunction unloadAction(action: any) {\n    delete BarItems[action.id];\n\n    for (const toolbar of action.toolbars) {\n        let idx = 0;\n        while (idx < toolbar.children.length) {\n            const item = toolbar.children[idx];\n            if (item === action || item.id === action) {\n                toolbar.children.splice(idx, 1);\n                if (removeFromArray(item.toolbars, toolbar)) {\n                    const position = parseInt(\n                        Object.entries(toolbar.positionLookup).find(([_, item]) => item === action)[0]\n                    );\n                    if (position !== undefined) {\n                        if (toolbar.postload === undefined) {\n                            toolbar.postload = [];\n                        }\n                        toolbar.postload.push([action.id, position]);\n                    }\n                }\n            } else {\n                idx++;\n            }\n        }\n        toolbar.update();\n    }\n\n    if (removeFromArray(Keybinds.actions, action)) {\n        const category = action.category;\n        const structCategoryActions = Keybinds.structure[category].actions;\n        removeFromArray(structCategoryActions, action);\n        if (structCategoryActions.length == 0) {\n            delete Keybinds.structure[category];\n        }\n    }\n\n    Object.keys(action).forEach(prop => delete action[prop]);\n    action.id = \"DISABLED\";\n}\n","import { Mouseless } from \"./mouseless\";\n\nfunction sidebarAction(id: string, sides: string[], changeState: boolean | \"toggle\", opts: Partial<ActionOptions>) {\n    Mouseless.createAction(id, {\n        ...opts,\n        category: \"view\",\n        click: () => {\n            sides\n                .map(side => `show_${side}_bar`)\n                .forEach(side => {\n                    Prop[side] = changeState == \"toggle\" ? !Prop[side] : changeState;\n                });\n            resizeWindow();\n        },\n    } as ActionOptions);\n}\n\nexport function load() {\n    sidebarAction(\"toggle_left_sidebar\", [\"left\"], \"toggle\", {\n        name: \"Toggle Left Sidebar\",\n        icon: \"chevron_left\",\n    });\n    sidebarAction(\"toggle_right_sidebar\", [\"right\"], \"toggle\", {\n        name: \"Toggle Right Sidebar\",\n        icon: \"chevron_right\",\n    });\n    sidebarAction(\"hide_sidebars\", [\"left\", \"right\"], false, {\n        name: \"Hide both sidebars\",\n        icon: \"unfold_more\",\n    });\n    sidebarAction(\"show_sidebars\", [\"left\", \"right\"], true, {\n        name: \"Show both sidebars\",\n        icon: \"unfold_less\",\n    });\n\n    Mouseless.createAction(\"toggle_menubar\", {\n        name: \"Toggle Menu Bar\",\n        icon: \"menu_open\",\n        category: \"view\",\n        click: () => {\n            $(\"header\").toggle();\n            $(\"#page_wrapper\").toggleClass(\"h-100-override\");\n        },\n    });\n}\n","import { author, description } from \"@package-info\";\nimport { cssSource } from \"@bundle\";\n\nimport { Plugin } from \"bb-types\";\nimport { Mouseless } from \"./mouseless\";\n\nimport * as ui from \"./ui\";\n\nPlugin.register(\"mouseless\", {\n    icon: \"keyboard\",\n    title: \"Blockbench Mouseless\",\n    author: author,\n    description: description,\n    // eslint-disable-next-line @typescript-eslint/naming-convention\n    min_version: \"3.9\",\n    variant: \"both\",\n\n    onload: () => {\n        Mouseless.hook(cssSource);\n\n        ui.load();\n\n        Mouseless.postInit();\n    },\n    onunload: () => {\n        Mouseless.unhook();\n    },\n});\n"],"names":[],"mappings":"knBAAgB,eAAe,CAAI,KAAU,CAAE,GAAM,QAC3C,QAAQ,CAAG,KAAK,CAAC,OAAO,CAAC,GAAG,KAC9B,QAAQ,EAAI,EAAE,EACd,KAAK,CAAC,MAAM,CAAC,QAAQ,CAAE,CAAC,SACjB,IAAI,SAER,KAAK,0CCHR,YAAY,OAGV,OAAO,aAEG,YAAY,CAAC,EAAU,CAAE,IAAmB,EACxD,OAAO,CAAC,IAAI,KAAK,MAAM,CAAC,EAAE,CAAE,IAAI,eADpB,YAAY,CAAZ,YAAY,UAIZ,IAAI,CAAC,SAAkB,KAC/B,SAAS,GAAK,SAAS,EACvB,YAAY,CAAG,QAAQ,CAAC,aAAa,EAAC,KAAO,GAC7C,YAAY,CAAC,EAAE,EAAG,aAAe,EACjC,YAAY,CAAC,SAAS,CAAG,SAAS,CAClC,QAAQ,CAAC,oBAAoB,EAAC,IAAM,GAAE,CAAC,EAAE,WAAW,CAAC,YAAY,eALzD,IAAI,CAAJ,IAAI,UASJ,QAAQ,GACpB,MAAM,CAAC,MAAM,CAAC,QAAQ,EAAE,OAAO,CAAC,OAAO,MAC9B,OAAO,CAAS,QAAQ,EACzB,OAAO,CAAC,GAAG,CAAC,OAAO,EACnB,OAAO,CAAC,MAAM,mBAJV,QAAQ,CAAR,QAAQ,UASR,MAAM,GAClB,YAAY,CAAC,MAAM,GACnB,OAAO,CAAC,OAAO,CAAC,YAAY,cAFhB,MAAM,CAAN,MAAM,IA5BT,SAAS,GAAT,SAAS,eAuCjB,YAAY,CAAC,MAAW,SACtB,QAAQ,CAAC,MAAM,CAAC,EAAE,YAEd,OAAO,IAAI,MAAM,CAAC,QAAQ,MAC7B,GAAG,CAAG,CAAC,OACJ,GAAG,CAAG,OAAO,CAAC,QAAQ,CAAC,MAAM,QAC1B,IAAI,CAAG,OAAO,CAAC,QAAQ,CAAC,GAAG,KAC7B,IAAI,GAAK,MAAM,EAAI,IAAI,CAAC,EAAE,GAAK,MAAM,EACrC,OAAO,CAAC,QAAQ,CAAC,MAAM,CAAC,GAAG,CAAE,CAAC,qBACV,IAAI,CAAC,QAAQ,CAAE,OAAO,SAChC,QAAQ,CAAG,QAAQ,CACrB,MAAM,CAAC,OAAO,CAAC,OAAO,CAAC,cAAc,EAAE,IAAI,GAAG,CAAC,CAAE,KAAI,IAAM,KAAI,GAAK,MAAM,EAAE,CAAC,MAE7E,QAAQ,GAAK,SAAS,KAClB,OAAO,CAAC,QAAQ,GAAK,SAAS,CAC9B,OAAO,CAAC,QAAQ,IAEpB,OAAO,CAAC,QAAQ,CAAC,IAAI,EAAE,MAAM,CAAC,EAAE,CAAE,QAAQ,WAIlD,GAAG,IAGX,OAAO,CAAC,MAAM,uBAGE,QAAQ,CAAC,OAAO,CAAE,MAAM,SAClC,QAAQ,CAAG,MAAM,CAAC,QAAQ,OAC1B,qBAAqB,CAAG,QAAQ,CAAC,SAAS,CAAC,QAAQ,EAAE,OAAO,iBAClD,qBAAqB,CAAE,MAAM,KACzC,qBAAqB,CAAC,MAAM,EAAI,CAAC,QAC1B,QAAQ,CAAC,SAAS,CAAC,QAAQ,GAI1C,MAAM,CAAC,IAAI,CAAC,MAAM,EAAE,OAAO,CAAC,IAAI,SAAW,MAAM,CAAC,IAAI,GACtD,MAAM,CAAC,EAAE,EAAG,QAAU,YC5EjB,aAAa,CAAC,EAAU,CAAE,KAAe,CAAE,WAA+B,CAAE,IAA4B,YACnG,YAAY,CAAC,EAAE,kBAClB,IAAI,EACP,QAAQ,EAAE,IAAM,EAChB,KAAK,MACD,KAAK,CACA,GAAG,CAAC,IAAI,GAAK,KAAK,EAAE,IAAI,CAAC,IAAI,GAC7B,OAAO,CAAC,IAAI,GACT,IAAI,CAAC,IAAI,EAAI,WAAW,GAAI,MAAQ,GAAI,IAAI,CAAC,IAAI,EAAI,WAAW,IAExE,YAAY,kBAKR,IAAI,GAChB,aAAa,EAAC,mBAAqB,IAAG,IAAM,IAAG,MAAQ,GACnD,IAAI,EAAE,mBAAqB,EAC3B,IAAI,EAAE,YAAc,IAExB,aAAa,EAAC,oBAAsB,IAAG,KAAO,IAAG,MAAQ,GACrD,IAAI,EAAE,oBAAsB,EAC5B,IAAI,EAAE,aAAe,IAEzB,aAAa,EAAC,aAAe,IAAG,IAAM,GAAE,KAAO,GAAG,KAAK,EACnD,IAAI,EAAE,kBAAoB,EAC1B,IAAI,EAAE,WAAa,IAEvB,aAAa,EAAC,aAAe,IAAG,IAAM,GAAE,KAAO,GAAG,IAAI,EAClD,IAAI,EAAE,kBAAoB,EAC1B,IAAI,EAAE,WAAa,cAGb,YAAY,EAAC,cAAgB,GACnC,IAAI,EAAE,eAAiB,EACvB,IAAI,EAAE,SAAW,EACjB,QAAQ,EAAE,IAAM,EAChB,KAAK,MACD,CAAC,EAAC,MAAQ,GAAE,MAAM,GAClB,CAAC,EAAC,aAAe,GAAE,WAAW,EAAC,cAAgB,eCjCpD,QAAQ,EAAC,SAAW,GACvB,IAAI,EAAE,QAAU,EAChB,KAAK,EAAE,oBAAsB,EAC7B,MAAM,UACN,WAAW,uEAEX,WAAW,EAAE,GAAK,EAClB,OAAO,EAAE,IAAM,EAEf,MAAM,gBACQ,IAAI,6DAIJ,QAAQ,KAEtB,QAAQ,gBACM,MAAM"}